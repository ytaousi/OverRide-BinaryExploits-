int auth(char *charArray,uint serialNumberVariable)
{
  size_t sVar1;
  int returnValueVariable;
  long longValueVariable;
  int arrayIndexVariable;
  uint serializedValueVariable;
  
  sVar1 = strcspn(charArray,"\n");
  charArray[sVar1] = '\0';
  sVar1 = strnlen(charArray,32);
  if ((int)sVar1 < 6)
    returnValueVariable; = 1;
  else 
  {
    longValueVariable = ptrace(PTRACE_TRACEME);
    if (longValueVariable == -1)
    {
      puts("\x1b[32m.---------------------------.");
      puts("\x1b[31m| !! TAMPERING DETECTED !!  |");
      puts("\x1b[32m\'---------------------------\'");
      returnValueVariable; = 1;
    }
    else  // serialization process
    {
      serializedValueVariable = ((int)charArray[3] ^ 4919) + 6221293; //Hexadecimal representation : 0x5eeded , Hexadecimal representation : 0x1337U
      for (arrayIndexVariable = 0; arrayIndexVariable < (int)sVar1; arrayIndexVariable = arrayIndexVariable + 1)
      {
        if (charArray[arrayIndexVariable] < ' ')
          return 1;
        serializedValueVariable = serializedValueVariable + ((int)charArray[arrayIndexVariable] ^ serializedValueVariable) % 1337; // Hexadecimal representation : 0x539
      }
      if (serialNumberVariable == serializedValueVariable) // compared with the serial number entered by the user
        returnValueVariable; = 0;
      else
        returnValueVariable; = 1;
    }
  }
  return returnValueVariable;
}

bool main(undefined4 param_1,undefined4 param_2)
{
  int iVar1;
  int in_GS_OFFSET;
  uint serialNumberVariable;
  char charArray[32];
  int local_14;
  
  local_14 = *(int *)(in_GS_OFFSET + 0x14);
  puts("***********************************");
  puts("*\t\tlevel06\t\t  *");
  puts("***********************************");
  printf("-> Enter Login: ");
  fgets(charArray,0x20,stdin);
  puts("***********************************");
  puts("***** NEW ACCOUNT DETECTED ********");
  puts("***********************************");
  printf("-> Enter Serial: ");
  __isoc99_scanf();
  iVar1 = auth(charArray,serialNumberVariable);
  if (iVar1 == 0) 
  {
    puts("Authenticated!");
    system("/bin/sh");
  }
  if (local_14 != *(int *)(in_GS_OFFSET + 0x14))
    __stack_chk_fail(); /* WARNING: Subroutine does not return */
  return iVar1 != 0;
}